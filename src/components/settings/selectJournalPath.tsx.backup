import { Button } from "#/components/shared/Button";
import { useState } from "react";
import { open } from "@tauri-apps/plugin-dialog";
import { Loader, Loader2 } from "lucide-react";

export default function ChooseJournalDirectory({
	initialJournalPath = null,
}: {
	initialJournalPath: string | null;
}) {
	const [journalPath, setJournalPath] = useState<string | null>(
		initialJournalPath,
	);
	const [isSelecting, setIsSelecting] = useState(false);

	const handlePathChange = () => {
		setIsSelecting(true);
		const file = open({
			multiple: false,
			directory: true,
		})
			.then((path) => {
				console.log(path);
				setJournalPath(path);
			})
			.finally(() => setIsSelecting(false));
	};

	return (
		<div className="space-y-4">
			<h3 className="text-lg font-semibold">Select Journal Path</h3>
			<p className="text-sm text-muted-foreground">
				Choose the path where your journal files are stored. This will help in
				automatically extracting metrics from your journal entries.
			</p>
			{journalPath && <p>Current path {journalPath}</p>}
			<Button
				variant="primary"
				className="cursor-pointer"
				disabled={isSelecting}
				onClick={handlePathChange}
			>
				<span className="flex items-center gap-2">
					{isSelecting && <Loader2 className="animate-spin" />}
					Select your journal Directory
				</span>
			</Button>
		</div>
	);
}
